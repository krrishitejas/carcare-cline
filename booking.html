<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Service - CarCare</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .hero-bg {
            background: linear-gradient(135deg, #0A2342 0%, #1a3a5f 100%);
        }
        
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .nav-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid #e5e7eb;
        }
        
        .nav-item {
            transition: all 0.2s ease;
        }
        
        .nav-item.active {
            color: #D72638;
        }
        
        .nav-item:not(.active) {
            color: #6b7280;
        }
        
        .service-card {
            transition: all 0.2s ease;
        }
        
        .service-card.selected {
            border-color: #D72638;
            background-color: #fef2f2;
        }
        
        .dealer-card {
            transition: all 0.2s ease;
        }
        
        .dealer-card:active {
            transform: scale(0.98);
        }
        
        .time-slot {
            transition: all 0.2s ease;
        }
        
        .time-slot.selected {
            background-color: #D72638;
            color: white;
        }
        
        .time-slot.unavailable {
            background-color: #f3f4f6;
            color: #9ca3af;
            cursor: not-allowed;
        }
        
        .calendar-day {
            transition: all 0.2s ease;
        }
        
        .calendar-day.selected {
            background-color: #D72638;
            color: white;
        }
        
        .calendar-day.today {
            border: 2px solid #D72638;
        }
        
        .step-indicator {
            transition: all 0.3s ease;
        }
        
        .step-indicator.active {
            background-color: #D72638;
            color: white;
        }
        
        .step-indicator.completed {
            background-color: #2ECC71;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50 pb-16">
    <!-- Header -->
    <div class="hero-bg text-white px-4 py-6">
        <div class="flex items-center justify-between mb-4">
            <button onclick="goBack()" class="p-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </button>
            <h1 class="text-xl font-bold">Book Service</h1>
            <button onclick="showBookingHistory()" class="p-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
            </button>
        </div>
        
        <!-- Step Indicator -->
        <div class="flex items-center justify-center space-x-4">
            <div class="step-indicator active w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold" id="step-1">1</div>
            <div class="w-8 h-0.5 bg-gray-400" id="line-1"></div>
            <div class="step-indicator w-8 h-8 rounded-full bg-gray-400 flex items-center justify-center text-sm font-bold" id="step-2">2</div>
            <div class="w-8 h-0.5 bg-gray-400" id="line-2"></div>
            <div class="step-indicator w-8 h-8 rounded-full bg-gray-400 flex items-center justify-center text-sm font-bold" id="step-3">3</div>
        </div>
        <div class="flex justify-between mt-2 text-xs text-blue-100">
            <span>Service</span>
            <span>Dealer</span>
            <span>Time</span>
        </div>
    </div>

    <!-- Service Selection Step -->
    <div id="service-step" class="px-4 py-6">
        <h2 class="text-lg font-semibold text-gray-800 mb-4">Select Service</h2>
        
        <div class="space-y-4">
            <div class="service-card bg-white rounded-lg card-shadow p-4 border-2 border-transparent cursor-pointer" onclick="selectService('basic_wash', 25)">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <img src="resources/service-wash.jpg" alt="Basic Wash" class="w-16 h-16 rounded-lg object-cover">
                        <div>
                            <h3 class="font-semibold text-gray-800">Basic Wash</h3>
                            <p class="text-sm text-gray-500">Exterior wash, dry, and tire shine</p>
                            <div class="flex items-center mt-1">
                                <div class="flex text-yellow-400">
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                </div>
                                <span class="text-xs text-gray-500 ml-1">(4.8)</span>
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-gray-800">$25</div>
                        <div class="text-xs text-green-600">30 min</div>
                    </div>
                </div>
            </div>
            
            <div class="service-card bg-white rounded-lg card-shadow p-4 border-2 border-transparent cursor-pointer" onclick="selectService('premium_wash', 45)">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <img src="resources/service-wash.jpg" alt="Premium Wash" class="w-16 h-16 rounded-lg object-cover">
                        <div>
                            <h3 class="font-semibold text-gray-800">Premium Wash</h3>
                            <p class="text-sm text-gray-500">Full service including interior vacuum</p>
                            <div class="flex items-center mt-1">
                                <div class="flex text-yellow-400">
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                </div>
                                <span class="text-xs text-gray-500 ml-1">(4.9)</span>
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-gray-800">$45</div>
                        <div class="text-xs text-green-600">45 min</div>
                    </div>
                </div>
            </div>
            
            <div class="service-card bg-white rounded-lg card-shadow p-4 border-2 border-transparent cursor-pointer" onclick="selectService('detailing', 120)">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <img src="resources/service-wash.jpg" alt="Full Detailing" class="w-16 h-16 rounded-lg object-cover">
                        <div>
                            <h3 class="font-semibold text-gray-800">Full Detailing</h3>
                            <p class="text-sm text-gray-500">Complete interior and exterior detailing</p>
                            <div class="flex items-center mt-1">
                                <div class="flex text-yellow-400">
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                </div>
                                <span class="text-xs text-gray-500 ml-1">(4.9)</span>
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-gray-800">$120</div>
                        <div class="text-xs text-green-600">2-3 hours</div>
                    </div>
                </div>
            </div>
        </div>
        
        <button id="service-next-btn" class="w-full bg-gray-300 text-gray-500 p-4 rounded-lg font-medium mt-6 cursor-not-allowed" disabled onclick="nextStep()">
            Select a service to continue
        </button>
    </div>

    <!-- Dealer Selection Step -->
    <div id="dealer-step" class="px-4 py-6 hidden">
        <h2 class="text-lg font-semibold text-gray-800 mb-4">Choose Service Center</h2>
        
        <div class="mb-4">
            <div class="flex items-center space-x-2 mb-2">
                <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <span class="text-sm text-gray-600">Showing dealers near you</span>
            </div>
        </div>
        
        <div class="space-y-3" id="dealers-container">
            <!-- Dealers will be populated by JavaScript -->
        </div>
        
        <button id="dealer-next-btn" class="w-full bg-gray-300 text-gray-500 p-4 rounded-lg font-medium mt-6 cursor-not-allowed" disabled onclick="nextStep()">
            Select a dealer to continue
        </button>
    </div>

    <!-- Time Selection Step -->
    <div id="time-step" class="px-4 py-6 hidden">
        <h2 class="text-lg font-semibold text-gray-800 mb-4">Select Date & Time</h2>
        
        <!-- Calendar -->
        <div class="bg-white rounded-lg card-shadow p-4 mb-6">
            <h3 class="font-medium text-gray-800 mb-3">Choose Date</h3>
            <div class="grid grid-cols-7 gap-1 text-center text-xs mb-2">
                <div class="font-medium text-gray-500 p-2">Sun</div>
                <div class="font-medium text-gray-500 p-2">Mon</div>
                <div class="font-medium text-gray-500 p-2">Tue</div>
                <div class="font-medium text-gray-500 p-2">Wed</div>
                <div class="font-medium text-gray-500 p-2">Thu</div>
                <div class="font-medium text-gray-500 p-2">Fri</div>
                <div class="font-medium text-gray-500 p-2">Sat</div>
            </div>
            <div class="grid grid-cols-7 gap-1" id="calendar-grid">
                <!-- Calendar days will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Time Slots -->
        <div class="bg-white rounded-lg card-shadow p-4 mb-6">
            <h3 class="font-medium text-gray-800 mb-3">Available Times</h3>
            <div class="grid grid-cols-3 gap-2" id="time-slots">
                <!-- Time slots will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Booking Summary -->
        <div class="bg-white rounded-lg card-shadow p-4 mb-6" id="booking-summary" style="display: none;">
            <h3 class="font-medium text-gray-800 mb-3">Booking Summary</h3>
            <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-600">Service:</span>
                    <span class="font-medium" id="summary-service">-</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Dealer:</span>
                    <span class="font-medium" id="summary-dealer">-</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Date & Time:</span>
                    <span class="font-medium" id="summary-datetime">-</span>
                </div>
                <div class="flex justify-between border-t pt-2 mt-2">
                    <span class="text-gray-600">Total:</span>
                    <span class="font-bold text-lg text-red-600" id="summary-price">-</span>
                </div>
            </div>
        </div>
        
        <button id="confirm-booking-btn" class="w-full bg-gray-300 text-gray-500 p-4 rounded-lg font-medium cursor-not-allowed" disabled onclick="confirmBooking()">
            Select date & time to book
        </button>
    </div>

    <!-- Bottom Navigation -->
    <div class="nav-bar">
        <div class="flex items-center justify-around py-2">
            <a href="index.html" class="nav-item flex flex-col items-center py-2 px-4">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                </svg>
                <span class="text-xs">Home</span>
            </a>
            <a href="booking.html" class="nav-item active flex flex-col items-center py-2 px-4">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span class="text-xs">Book</span>
            </a>
            <a href="locator.html" class="nav-item flex flex-col items-center py-2 px-4">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <span class="text-xs">Locator</span>
            </a>
            <a href="expenses.html" class="nav-item flex flex-col items-center py-2 px-4">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                </svg>
                <span class="text-xs">Expenses</span>
            </a>
            <a href="notifications.html" class="nav-item flex flex-col items-center py-2 px-4">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM11 19H6.5A2.5 2.5 0 014 16.5v-9A2.5 2.5 0 016.5 5h11A2.5 2.5 0 0120 7.5v3.5"></path>
                </svg>
                <span class="text-xs">Alerts</span>
            </a>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
        let bookingData = {
            service: null,
            servicePrice: 0,
            dealer: null,
            date: null,
            time: null
        };

        let currentStep = 1;

        function selectService(serviceType, price) {
            // Remove previous selection
            document.querySelectorAll('.service-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selection to clicked card
            event.currentTarget.classList.add('selected');
            
            bookingData.service = serviceType;
            bookingData.servicePrice = price;
            
            // Enable next button
            const nextBtn = document.getElementById('service-next-btn');
            nextBtn.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
            nextBtn.classList.add('bg-red-600', 'text-white');
            nextBtn.disabled = false;
            nextBtn.textContent = 'Continue to Dealer Selection';
        }

        function selectDealer(dealerId) {
            // Remove previous selection
            document.querySelectorAll('.dealer-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selection to clicked card
            event.currentTarget.classList.add('selected');
            
            bookingData.dealer = dealerId;
            
            // Enable next button
            const nextBtn = document.getElementById('dealer-next-btn');
            nextBtn.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
            nextBtn.classList.add('bg-red-600', 'text-white');
            nextBtn.disabled = false;
            nextBtn.textContent = 'Continue to Time Selection';
        }

        function selectDate(date) {
            // Remove previous selection
            document.querySelectorAll('.calendar-day').forEach(day => {
                day.classList.remove('selected');
            });
            
            // Add selection to clicked day
            event.currentTarget.classList.add('selected');
            
            bookingData.date = date;
            
            // Generate time slots
            generateTimeSlots();
            
            checkTimeStepCompletion();
        }

        function selectTime(time) {
            // Remove previous selection
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
            
            // Add selection to clicked slot
            event.currentTarget.classList.add('selected');
            
            bookingData.time = time;
            
            checkTimeStepCompletion();
        }

        function checkTimeStepCompletion() {
            if (bookingData.date && bookingData.time) {
                // Show booking summary
                document.getElementById('booking-summary').style.display = 'block';
                updateBookingSummary();
                
                // Enable confirm button
                const confirmBtn = document.getElementById('confirm-booking-btn');
                confirmBtn.classList.remove('bg-gray-300', 'text-gray-500', 'cursor-not-allowed');
                confirmBtn.classList.add('bg-red-600', 'text-white');
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Booking';
            }
        }

        function updateBookingSummary() {
            const serviceNames = {
                'basic_wash': 'Basic Wash',
                'premium_wash': 'Premium Wash',
                'detailing': 'Full Detailing'
            };
            
            const dealer = CarCareApp.garages.find(g => g.id === bookingData.dealer);
            
            document.getElementById('summary-service').textContent = serviceNames[bookingData.service];
            document.getElementById('summary-dealer').textContent = dealer ? dealer.name : '-';
            document.getElementById('summary-datetime').textContent = `${bookingData.date} at ${bookingData.time}`;
            document.getElementById('summary-price').textContent = `$${bookingData.servicePrice}`;
        }

        function nextStep() {
            if (currentStep === 1) {
                // Move to dealer selection
                document.getElementById('service-step').classList.add('hidden');
                document.getElementById('dealer-step').classList.remove('hidden');
                
                // Update step indicator
                document.getElementById('step-1').classList.remove('active');
                document.getElementById('step-1').classList.add('completed');
                document.getElementById('step-2').classList.add('active');
                document.getElementById('line-1').classList.add('bg-red-600');
                
                // Populate dealers
                populateDealers();
                
                currentStep = 2;
            } else if (currentStep === 2) {
                // Move to time selection
                document.getElementById('dealer-step').classList.add('hidden');
                document.getElementById('time-step').classList.remove('hidden');
                
                // Update step indicator
                document.getElementById('step-2').classList.remove('active');
                document.getElementById('step-2').classList.add('completed');
                document.getElementById('step-3').classList.add('active');
                document.getElementById('line-2').classList.add('bg-red-600');
                
                // Generate calendar
                generateCalendar();
                
                currentStep = 3;
            }
        }

        function populateDealers() {
            const container = document.getElementById('dealers-container');
            container.innerHTML = '';
            
            CarCareApp.garages.forEach(dealer => {
                const dealerCard = document.createElement('div');
                dealerCard.className = 'dealer-card bg-white rounded-lg card-shadow p-4 cursor-pointer';
                dealerCard.onclick = () => selectDealer(dealer.id);
                
                dealerCard.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <img src="${dealer.image}" alt="${dealer.name}" class="w-16 h-16 rounded-lg object-cover">
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-800">${dealer.name}</h3>
                            <p class="text-sm text-gray-500">${dealer.distance} away</p>
                            <div class="flex items-center mt-1">
                                <div class="flex text-yellow-400">
                                    ${Array(5).fill('<svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>').join('')}
                                </div>
                                <span class="text-xs text-gray-500 ml-1">(${dealer.rating})</span>
                            </div>
                            <div class="flex flex-wrap gap-1 mt-2">
                                ${dealer.services.map(service => `
                                    <span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded">${service.replace('_', ' ')}</span>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(dealerCard);
            });
        }

        function generateCalendar() {
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';
            
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            // Get first day of month and number of days
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'p-2';
                grid.appendChild(emptyDay);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day p-2 text-center cursor-pointer rounded hover:bg-gray-100';
                dayElement.textContent = day;
                
                const dateString = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                // Mark today
                if (day === today.getDate()) {
                    dayElement.classList.add('today');
                }
                
                // Only allow future dates
                if (day >= today.getDate()) {
                    dayElement.onclick = () => selectDate(dateString);
                } else {
                    dayElement.classList.add('text-gray-300', 'cursor-not-allowed');
                }
                
                grid.appendChild(dayElement);
            }
        }

        function generateTimeSlots() {
            const container = document.getElementById('time-slots');
            container.innerHTML = '';
            
            const timeSlots = [
                '9:00 AM', '10:00 AM', '11:00 AM', '12:00 PM',
                '1:00 PM', '2:00 PM', '3:00 PM', '4:00 PM',
                '5:00 PM', '6:00 PM'
            ];
            
            timeSlots.forEach((time, index) => {
                const timeSlot = document.createElement('div');
                timeSlot.className = 'time-slot p-3 text-center text-sm font-medium border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50';
                timeSlot.textContent = time;
                
                // Make some slots unavailable for demo
                if (index % 3 === 0) {
                    timeSlot.classList.add('unavailable');
                    timeSlot.onclick = null;
                } else {
                    timeSlot.onclick = () => selectTime(time);
                }
                
                container.appendChild(timeSlot);
            });
        }

        function confirmBooking() {
            // Create booking object
            const booking = {
                id: Date.now(),
                service: bookingData.service,
                dealer: bookingData.dealer,
                date: bookingData.date,
                time: bookingData.time,
                price: bookingData.servicePrice,
                status: 'confirmed',
                created: new Date().toISOString()
            };
            
            // Add to bookings (in real app, this would be sent to server)
            CarCareApp.bookings.push(booking);
            
            // Show success message
            Utils.showToast('Booking confirmed successfully!', 'success');
            
            // Redirect to home after delay
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 2000);
        }

        function goBack() {
            if (currentStep === 1) {
                window.location.href = 'index.html';
            } else if (currentStep === 2) {
                document.getElementById('dealer-step').classList.add('hidden');
                document.getElementById('service-step').classList.remove('hidden');
                
                // Update step indicator
                document.getElementById('step-1').classList.add('active');
                document.getElementById('step-1').classList.remove('completed');
                document.getElementById('step-2').classList.remove('active');
                document.getElementById('line-1').classList.remove('bg-red-600');
                
                currentStep = 1;
            } else if (currentStep === 3) {
                document.getElementById('time-step').classList.add('hidden');
                document.getElementById('dealer-step').classList.remove('hidden');
                
                // Update step indicator
                document.getElementById('step-2').classList.add('active');
                document.getElementById('step-2').classList.remove('completed');
                document.getElementById('step-3').classList.remove('active');
                document.getElementById('line-2').classList.remove('bg-red-600');
                
                currentStep = 2;
            }
        }

        function showBookingHistory() {
            alert('Booking history feature coming soon!');
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Animate service cards
            Animations.staggerCards('.service-card');
        });
    </script>
</body>
</html>